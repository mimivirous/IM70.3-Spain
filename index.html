<!-- Chosen Palette: Coastal Horizon (Main: White/Light Gray, Accent: Indigo-600, Secondary Accent: Amber-600) -->
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ironman è¥¿ç­ç‰™ 12 æ—¥æ¢ç´¢å„€è¡¨æ¿</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f7f7f7; }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 450px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container { max-width: 600px; height: 400px; }
        }
        .timeline-dot {
            position: absolute;
            left: -15px;
            top: 5px;
            width: 15px;
            height: 15px;
            background-color: #4f46e5;
            border-radius: 50%;
            border: 3px solid #f7f7f7;
        }
        .timeline-item { position: relative; padding-left: 20px; border-left: 2px solid #e0e0e0; margin-bottom: 10px; }
    </style>
</head>
<body class="antialiased text-gray-800">

    <!-- Header Navigation -->
    <header class="sticky top-0 z-50 bg-white shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <h1 class="text-2xl font-bold text-indigo-600">ğŸ‡ªğŸ‡¸ Ironman è¥¿ç­ç‰™ (12æ—¥è¡Œç¨‹)</h1>
            <nav class="space-x-4">
                <a href="#dashboard" class="text-gray-600 hover:text-indigo-600 transition duration-150 font-medium hidden sm:inline">å„€è¡¨æ¿</a>
                <a href="#itinerary" class="text-gray-600 hover:text-indigo-600 transition duration-150 font-medium">è¡Œç¨‹æ™‚é–“è»¸</a>
                <a href="#logistics" class="text-gray-600 hover:text-indigo-600 transition duration-150 font-medium hidden sm:inline">ç‰©æµ/è²»ç”¨</a>
            </nav>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">

        <!-- Dashboard Section -->
        <section id="dashboard" class="mb-12">
            <h2 class="text-3xl font-extrabold text-indigo-700 mb-6 border-b-2 border-indigo-200 pb-2">ğŸ¯ æ—…ç¨‹æ¦‚è¦½èˆ‡æº–å‚™è¡Œå‹•</h2>
            <p class="mb-8 text-gray-600">
                æœ¬å„€è¡¨æ¿åŒ¯é›†äº† **12 æ—¥**è¥¿ç­ç‰™ä¹‹æ—…çš„é—œéµæ•¸æ“šã€‚11/4 æŠµé”é¦¬å¾·é‡Œå¾Œç›´æ¥å‰å¾€æ‰˜é›·å¤šï¼Œé–‹å•Ÿç²¾å½©æ—…ç¨‹ï¼
            </p>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-10">
                <div class="p-5 bg-white rounded-xl shadow-lg border-b-4 border-indigo-500 transform hover:scale-[1.02] transition duration-200">
                    <p class="text-sm font-medium text-gray-500">ç¸½æ—¥æ•¸</p>
                    <p id="stat-days" class="text-3xl font-bold text-indigo-800">12</p>
                </div>
                <div class="p-5 bg-white rounded-xl shadow-lg border-b-4 border-indigo-500 transform hover:scale-[1.02] transition duration-200">
                    <p class="text-sm font-medium text-gray-500">åƒèˆ‡äººæ•¸</p>
                    <p id="stat-people" class="text-3xl font-bold text-indigo-800">8 ä½</p>
                </div>
                <div class="p-5 bg-white rounded-xl shadow-lg border-b-4 border-amber-500 transform hover:scale-[1.02] transition duration-200">
                    <p class="text-sm font-medium text-gray-500">äº¤é€šå·¥å…·</p>
                    <p id="stat-transport" class="text-3xl font-bold text-amber-800">2 è¼›ç§Ÿè»Š</p>
                </div>
                <div class="p-5 bg-white rounded-xl shadow-lg border-b-4 border-amber-500 transform hover:scale-[1.02] transition duration-200">
                    <p class="text-sm font-medium text-gray-500">æ¯”è³½åœ°é»</p>
                    <p id="stat-race" class="text-xl font-bold text-amber-800 mt-1">Marbella</p>
                </div>
            </div>

            <!-- Interactive Checklist -->
            <div class="p-6 bg-white rounded-xl shadow-2xl">
                <h3 class="text-xl font-bold text-indigo-600 mb-4">âœ… è¡Œå‰æº–å‚™æ¸…å–®</h3>
                <p class="text-sm text-gray-500 mb-4">é»æ“Šé …ç›®å³å¯è¿½è¹¤å®Œæˆç‹€æ…‹ã€‚</p>
                <div id="checklist-container" class="space-y-3">
                    <!-- Checklist items will be injected here by JS -->
                </div>
            </div>
        </section>

        <!-- Itinerary Section (Timeline) -->
        <section id="itinerary" class="mb-12 pt-10">
            <h2 class="text-3xl font-extrabold text-indigo-700 mb-6 border-b-2 border-indigo-200 pb-2">ğŸ“… 12 æ—¥è¡Œç¨‹æ™‚é–“è»¸ (é»æ“ŠæŸ¥çœ‹ç´°ç¯€)</h2>
            <p class="mb-8 text-gray-600">
                å¾æ‰˜é›·å¤šå¤åŸåˆ°é¦¬è²æ‹‰æµ·ç˜ï¼Œå¾æ ¼æ‹‰ç´é”çš„é˜¿çˆ¾ç½•å¸ƒæ‹‰å®®åˆ°å¡ç¶­äºçš„ä½›æœ—æ˜å“¥ï¼Œç²¾å½© 12 å¤©ç­‰ä½ æ¢ç´¢ï¼
            </p>

            <div id="timeline-container" class="relative">
                <!-- Timeline items will be injected here by JS -->
            </div>
        </section>

        <!-- Logistics & Cost Section -->
        <section id="logistics" class="pt-10">
            <h2 class="text-3xl font-extrabold text-indigo-700 mb-6 border-b-2 border-indigo-200 pb-2">ğŸ’° ç‰©æµèˆ‡è²»ç”¨åˆ†æ</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Logistics Summary Card -->
                <div class="p-6 bg-white rounded-xl shadow-2xl flex flex-col justify-center">
                    <h3 class="text-xl font-bold text-indigo-600 mb-3">ğŸš— æ ¸å¿ƒç‰©æµæ±ºç­–</h3>
                    <div class="space-y-4 text-gray-700">
                        <div class="p-3 bg-indigo-50 rounded-lg">
                            <p class="font-semibold text-indigo-800">äº¤é€šæ–¹æ¡ˆ (å·²ç¢ºèª)</p>
                            <p>ç§Ÿè³ƒ **2 è¼›è»Š**ï¼Œå…¨ç¨‹è‡ªé§•ã€‚æ¯å°ç§Ÿé‡‘ $8,600ï¼ˆ11/4-11/14å…¨åŒ…ï¼‰ï¼Œèˆ’é©å®¹ç´ 8 äººå’Œæ‰€æœ‰è¡Œæï¼Œè¡Œç¨‹å½ˆæ€§æœ€é«˜ã€‚</p>
                        </div>
                        <div class="p-3 bg-amber-50 rounded-lg">
                            <p class="font-semibold text-amber-800">è‡ªè¡Œè»Šè™•ç† (å·²ç¢ºèª)</p>
                            <p>Ironman é¸æ‰‹ï¼ˆé›…èã€çš“ä¸­å“¥ã€å…‰æ­¦ï¼‰çš„è‡ªè¡Œè»Šå°‡åœ¨é¦¬è²æ‹‰ **ç•¶åœ°ç§Ÿè³ƒ**ï¼Œå…å»é•·é€”é‹è¼¸çš„éº»ç…©ã€‚</p>
                        </div>
                        <div class="p-3 bg-indigo-50 rounded-lg">
                            <p class="font-semibold text-indigo-800">ä½å®¿ç¸½çµ</p>
                            <p>ä½å®¿å®‰æ’ä»¥å…¬å¯“å’Œç²¾å“é…’åº—ç‚ºä¸»ï¼Œç¸½è²»ç”¨ç´„ $169,699ã€‚é¦¬è²æ‹‰æœŸé–“å…‰æ­¦çˆ¸åª½å¦å¤–ä½å®¿ï¼Œé¦¬å¾·é‡Œåˆ†å…©è™•ä½å®¿ã€‚</p>
                        </div>
                    </div>
                </div>

                <!-- Cost Chart Container -->
                <div>
                    <h3 class="text-xl font-bold text-indigo-600 mb-4 text-center">ç¸½é ä¼°è²»ç”¨ (ç´„ NT$<span id="total-cost">621,599</span>) åˆ†ä½ˆ</h3>
                    <p class="text-sm text-center text-gray-500 mb-2">å–®ä½ï¼šæ–°å°å¹£ (TWD)</p>
                    <div class="chart-container shadow-2xl rounded-xl bg-white p-4">
                        <canvas id="costBreakdownChart"></canvas>
                    </div>
                    <div class="mt-4 p-3 bg-amber-50 rounded-lg text-sm text-gray-600">
                        <p class="font-semibold text-amber-800 mb-2">ğŸ’¡ äº¤é€šè²»ç”¨æ˜ç´°ï¼ˆé ä¼°ï¼‰ï¼š</p>
                        <ul class="space-y-1 text-xs">
                            <li>â€¢ ç§Ÿè»Šå«ä¿éšªï¼š$17,200ï¼ˆ2å° Ã— $8,600ï¼‰</li>
                            <li>â€¢ æ²¹è²»ï¼š$15,700ï¼ˆç´„3,020kmï¼Œé ä¼°ï¼‰</li>
                            <li>â€¢ åœè»Šè²»ï¼š$3,500ï¼ˆå¸‚å€åœè»Šï¼Œé ä¼°ï¼‰</li>
                            <li>â€¢ éè·¯è²»ï¼š$1,500ï¼ˆé«˜é€Ÿå…¬è·¯ï¼Œé ä¼°ï¼‰</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Individual Cost Breakdown Table -->
            <div class="mt-12">
                <h3 class="text-2xl font-bold text-indigo-700 mb-6 text-center">ğŸ‘¥ æ¯äººè²»ç”¨æ˜ç´°</h3>
                
                <div class="bg-white rounded-xl shadow-2xl overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-indigo-600 text-white">
                                <tr>
                                    <th class="px-6 py-4 text-left font-semibold">æˆå“¡</th>
                                    <th class="px-6 py-4 text-right font-semibold">æ©Ÿç¥¨</th>
                                    <th class="px-6 py-4 text-right font-semibold">ä½å®¿</th>
                                    <th class="px-6 py-4 text-right font-semibold">äº¤é€š</th>
                                    <th class="px-6 py-4 text-right font-semibold">é¤è²»æ´»å‹•</th>
                                    <th class="px-6 py-4 text-right font-semibold bg-indigo-700">ç¸½è¨ˆ</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <!-- å…‰æ­¦ -->
                                <tr class="hover:bg-indigo-50 transition">
                                    <td class="px-6 py-4 font-medium text-gray-900">å…‰æ­¦</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$38,000</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$19,761</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$4,738</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$13,750</td>
                                    <td class="px-6 py-4 text-right font-bold text-indigo-700 bg-indigo-50">$76,249</td>
                                </tr>
                                <!-- è¿å‡¡ -->
                                <tr class="hover:bg-indigo-50 transition">
                                    <td class="px-6 py-4 font-medium text-gray-900">è¿å‡¡</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$38,000</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$19,761</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$4,738</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$13,750</td>
                                    <td class="px-6 py-4 text-right font-bold text-indigo-700 bg-indigo-50">$76,249</td>
                                </tr>
                                <!-- é›…è -->
                                <tr class="hover:bg-indigo-50 transition">
                                    <td class="px-6 py-4 font-medium text-gray-900">é›…è</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$38,000</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$19,761</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$4,738</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$13,750</td>
                                    <td class="px-6 py-4 text-right font-bold text-indigo-700 bg-indigo-50">$76,249</td>
                                </tr>
                                <!-- å…‰æ­¦çˆ¸çˆ¸ -->
                                <tr class="hover:bg-amber-50 transition">
                                    <td class="px-6 py-4 font-medium text-gray-900">å…‰æ­¦çˆ¸çˆ¸</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$38,000</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$26,043</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$4,738</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$13,750</td>
                                    <td class="px-6 py-4 text-right font-bold text-amber-700 bg-amber-50">$82,531</td>
                                </tr>
                                <!-- å…‰æ­¦åª½åª½ -->
                                <tr class="hover:bg-amber-50 transition">
                                    <td class="px-6 py-4 font-medium text-gray-900">å…‰æ­¦åª½åª½</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$38,000</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$26,043</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$4,738</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$13,750</td>
                                    <td class="px-6 py-4 text-right font-bold text-amber-700 bg-amber-50">$82,531</td>
                                </tr>
                                <!-- çš“ä¸­å“¥ -->
                                <tr class="hover:bg-indigo-50 transition">
                                    <td class="px-6 py-4 font-medium text-gray-900">çš“ä¸­å“¥</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$38,000</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$19,445</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$4,738</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$13,750</td>
                                    <td class="px-6 py-4 text-right font-bold text-indigo-700 bg-indigo-50">$75,933</td>
                                </tr>
                                <!-- æ´ªå¤§å“¥ -->
                                <tr class="hover:bg-indigo-50 transition">
                                    <td class="px-6 py-4 font-medium text-gray-900">æ´ªå¤§å“¥</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$38,000</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$19,445</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$4,738</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$13,750</td>
                                    <td class="px-6 py-4 text-right font-bold text-indigo-700 bg-indigo-50">$75,933</td>
                                </tr>
                                <!-- æ´ªå¤§å«‚ -->
                                <tr class="hover:bg-indigo-50 transition">
                                    <td class="px-6 py-4 font-medium text-gray-900">æ´ªå¤§å«‚</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$38,000</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$19,445</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$4,738</td>
                                    <td class="px-6 py-4 text-right text-gray-700">$13,750</td>
                                    <td class="px-6 py-4 text-right font-bold text-indigo-700 bg-indigo-50">$75,933</td>
                                </tr>
                            </tbody>
                            <tfoot class="bg-gray-100">
                                <tr class="font-bold text-lg">
                                    <td class="px-6 py-4 text-gray-900">ç¸½è¨ˆ</td>
                                    <td class="px-6 py-4 text-right text-gray-900">$304,000</td>
                                    <td class="px-6 py-4 text-right text-gray-900">$169,699</td>
                                    <td class="px-6 py-4 text-right text-gray-900">$37,900</td>
                                    <td class="px-6 py-4 text-right text-gray-900">$110,000</td>
                                    <td class="px-6 py-4 text-right text-indigo-900 bg-indigo-100">$621,599</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                    
                    <!-- ä½å®¿æ˜ç´°èªªæ˜ -->
                    <div class="px-6 py-4 bg-gray-50 border-t border-gray-200">
                        <p class="text-sm text-gray-600 mb-2"><strong>ğŸ’¡ ä½å®¿è²»ç”¨èªªæ˜ï¼š</strong></p>
                        <ul class="text-xs text-gray-600 space-y-1 ml-4">
                            <li>â€¢ <strong>å…‰æ­¦ã€è¿å‡¡ã€é›…è</strong>ï¼šé¦¬è²æ‹‰ 6 äººåˆ†æ“” ($37,310Ã·6) + é¦¬å¾·é‡Œä½å®¿ A 5 äººåˆ†æ“” ($26,579Ã·5) = $19,761</li>
                            <li>â€¢ <strong>å…‰æ­¦çˆ¸åª½</strong>ï¼šé¦¬è²æ‹‰å¦ä½ ($25,000Ã·2) + é¦¬å¾·é‡Œä½å®¿ A 5 äººåˆ†æ“” ($26,579Ã·5) + å…¶ä»–ä½å®¿ 8 äººå¹³å‡ = $26,043</li>
                            <li>â€¢ <strong>çš“ä¸­å“¥ã€æ´ªå¤§å“¥ã€æ´ªå¤§å«‚</strong>ï¼šé¦¬è²æ‹‰ 6 äººåˆ†æ“” ($37,310Ã·6) + é¦¬å¾·é‡Œä½å®¿ B 3 äººåˆ†æ“” ($15,000Ã·3) = $19,445</li>
                        </ul>
                    </div>
                </div>
            </div>

        </section>

    </main>

    <!-- Footer -->
    <footer class="mt-12 py-6 bg-gray-100 text-center text-sm text-gray-500">
        <p>&copy; 2025 Ironman è¥¿ç­ç‰™åœ˜éšŠè¦åŠƒ | è³‡æ–™æ›´æ–°æ—¥æœŸï¼š2025/10/29</p>
    </footer>

    <script>
        // Helper function to generate Google Maps link
        function getGoogleMapsLink(address) {
            const encodedAddress = encodeURIComponent(address);
            return `https://www.google.com/maps/search/?api=1&query=${encodedAddress}`;
        }

        const TRIP_DATA = {
            totalDays: 12,
            totalPeople: 8,
            raceLocation: "Marbella, Spain",
            estimatedCost: 621599,
            costBreakdown: [
                { label: "åœ‹éš›æ©Ÿç¥¨ (8äºº)", amount: 304000, percentage: 48.90, color: 'rgba(79, 70, 229, 0.8)' },
                { label: "ä½å®¿ (11æ™š)", amount: 169699, percentage: 27.30, color: 'rgba(234, 88, 12, 0.8)' },
                { label: "é¤è²»èˆ‡æ´»å‹•", amount: 110000, percentage: 17.70, color: 'rgba(251, 191, 36, 0.8)' },
                { label: "ç§Ÿè»Š/æ²¹è²»/åœè»Šè²» (é ä¼°)", amount: 37900, percentage: 6.10, color: 'rgba(129, 140, 248, 0.8)' }
            ]
        };

        let CHECKLIST_STATE = [
            { id: 1, text: "ç¢ºèªæ‰€æœ‰æˆå“¡è­·ç…§æ•ˆæœŸè¶…é 6 å€‹æœˆ", completed: false },
            { id: 2, text: "å®Œæˆ 2 è¼›ç§Ÿè»Šé è¨‚ (å«ä¿éšª)", completed: true },
            { id: 3, text: "ç¢ºèªæ‰€æœ‰é§•é§›åœ‹éš›é§•ç…§ (IDP) æ•ˆæœŸ", completed: false },
            { id: 4, text: "æ‰€æœ‰ä½å®¿é è¨‚ç¢ºèªèˆ‡ä»˜æ¬¾", completed: true },
            { id: 5, text: "Ironman è³½äº‹å ±åˆ°æ–‡ä»¶æº–å‚™ï¼ˆé›…èã€çš“ä¸­å“¥ã€å…‰æ­¦ï¼‰", completed: false },
            { id: 6, text: "ç¢ºèªç§Ÿè³ƒè‡ªè¡Œè»Šçš„å°ºå¯¸èˆ‡é ˜å–åœ°é»", completed: false },
            { id: 7, text: "è³¼è²·æ—…è¡Œ/æ„å¤–/é†«ç™‚ä¿éšª", completed: false },
            { id: 8, text: "é è¨‚é˜¿çˆ¾ç½•å¸ƒæ‹‰å®®é–€ç¥¨ï¼ˆéœ€æå‰ï¼‰", completed: false },
            { id: 9, text: "é è¨‚ä½›æœ—æ˜å“¥è¡¨æ¼”é–€ç¥¨", completed: false },
            { id: 10, text: "é è¨‚æ™®æ‹‰å¤šåšç‰©é¤¨ã€é¦¬å¾·é‡Œç‹å®®é–€ç¥¨ï¼ˆKlookï¼‰", completed: false },
        ];

        const ITINERARY_DATA = [
            { 
                day: 1, 
                date: "11/4 (äºŒ)", 
                location: "é¦¬å¾·é‡Œ â†’ æ‰˜é›·å¤š", 
                title: "é¦¬å¾·é‡Œ â†’ æ‰˜é›·å¤š", 
                transport: "12:40 æŠµé”é¦¬å¾·é‡Œï¼Œ14:30 é ˜å–ç§Ÿè»Šï¼Œè‡ªé§•è‡³æ‰˜é›·å¤š (1hr 15min)ã€‚", 
                activities: ["12:40 æŠµé”é¦¬å¾·é‡Œ", "14:30 é ˜å–ç§Ÿè»Š", "15:30-16:00 æŠµé”æ‰˜é›·å¤šä¸¦ check-in", "16:00-17:00 å°ä¼‘/å¸‚å€é€›é€›", "18:00 Mirador del Valle çœ‹æ—¥è½", "20:15 æ™šé¤", "22:00 ä¼‘æ¯èª¿æ•´æ™‚å·®"],
                food_recommendation: "å¿…åšç•¶åœ°ç”œé» MazapÃ¡n (æä»ç³–)ï¼Œä»¥åŠç¶“å…¸çš„æ‰˜é›·å¤šç‡‰è‚‰ Carcamusasã€‚",
                accommodationName: "Hotel Domus Plaza Zocodover",
                accommodationAddress: "Armas 7, æ‰˜èŠå¤š, 45001, è¥¿ç­ç‰™"
            },
            { 
                day: 2, 
                date: "11/5 (ä¸‰)", 
                location: "æ‰˜é›·å¤š â†’ æ ¼æ‹‰ç´é”", 
                title: "æ‰˜é›·å¤š â†’ æ ¼æ‹‰ç´é”", 
                transport: "SUV è‡ªé§• (æ‰˜é›·å¤š-æ ¼æ‹‰ç´é”: 4hrï¼Œå«20-30åˆ†é˜ä¼‘æ¯)ã€‚", 
                activities: ["07:30 æ™¨è·‘/æ•£æ­¥", "08:30 æ—©é¤", "10:00 æ‰˜é›·å¤šä¸»æ•™å ‚", "12:00 åˆé¤", "13:30 å‡ºç™¼", "ä¸­é€”ä¼‘æ¯ 20-30 åˆ†é˜", "18:00 æŠµé”æ ¼æ‹‰ç´é”", "20:00 æ™šé¤"],
                food_recommendation: "åœ¨æ‰˜èŠå¤šæˆ–æ ¼æ‹‰ç´é”é‚Šç·£ä¼‘æ¯ç«™äº«ç”¨åˆé¤ã€‚",
                accommodationName: "é˜¿é‡Œè–©ç†±æ–¯é…’åº—",
                accommodationAddress: "P.Âº de la Sabica, 40, 18009 æ ¼æ‹‰ç´é”, å®‰é”ç›§è¥¿äº, è¥¿ç­ç‰™"
            },
            { 
                day: 3, 
                date: "11/6 (å››)", 
                location: "æ ¼æ‹‰ç´é” â†’ é¦¬è²æ‹‰", 
                title: "æ ¼æ‹‰ç´é” â†’ é¦¬è²æ‹‰", 
                transport: "SUV è‡ªé§• (æ ¼æ‹‰ç´é”-é¦¬è²æ‹‰: 2hr)ã€‚", 
                activities: ["8:00 é˜¿çˆ¾ç½•å¸ƒæ‹‰å®®ï¼ˆè³¼ç¥¨ç¢°é‹æ°£ï¼‰", "08:30-09:45 ç´æ–¯é‡Œå¾·å®®", "09:45-11:00 èµ«å…§æ‹‰åˆ©è²»å®®èˆ‡èŠ±åœ’", "11:00-11:30 å½ˆæ€§æ™‚é–“", "11:30 é›¢é–‹ï¼Œåˆé¤", "13:00 å‡ºç™¼å¾€é¦¬è²æ‹‰", "16:00-16:30 æŠµé”é¦¬è²æ‹‰ä¸¦ check-in", "17:00-18:00 é¸æ‰‹å ±åˆ° + EXPO"],
                food_recommendation: "æ ¼æ‹‰ç´é”æä¾›å…è²» Tapasï¼é¤å¾Œç”œé»æ¨è–¦ Piononos (ä¸€ç¨®å°ç³•é»)ã€‚",
                accommodationName: "La Maestranza 8 b Lotta (4æ™š)",
                accommodationAddress: "Calle las ventas, Bajo, 29670 é¦¬è²æ‹‰, è¥¿ç­ç‰™"
            },
            { 
                day: 4, 
                date: "11/7 (äº”)", 
                location: "é¦¬è²æ‹‰", 
                title: "é¦¬è²æ‹‰ï¼ˆè³½äº‹æº–å‚™ï¼‰", 
                transport: "å¸‚å€å…§ç§»å‹•ã€‚", 
                activities: ["é ˜å–ç§Ÿè³ƒè‡ªè¡Œè»Šï¼ˆé›…èï¼‰", "EXPO åƒè§€", "æµ·åŸŸè©¦æ¸¸", "è³½é“å‹˜æŸ¥", "å¥³ç”Ÿè½‰æ›å€ Check-in", "é«˜ç¢³æ°´æ™šé¤", "æ—©é»ä¼‘æ¯"],
                food_recommendation: "è³½å‰æº–å‚™ï¼šä»¥å‡è¡¡çš„é«˜ç¢³æ°´åœ°ä¸­æµ·é£²é£Ÿç‚ºä¸»ã€‚",
                accommodationName: "La Maestranza 8 b Lotta (çºŒä½)",
                accommodationAddress: "Calle las ventas, Bajo, 29670 é¦¬è²æ‹‰, è¥¿ç­ç‰™"
            },
            { 
                day: 5, 
                date: "11/8 (å…­)", 
                location: "é¦¬è²æ‹‰", 
                title: "ğŸ”¥ é¦¬è²æ‹‰ï¼ˆå¥³å­çµ„è³½äº‹ï¼‰", 
                transport: "SUV å”åŠ©å¾Œå‹¤ã€‚", 
                activities: ["8:00 é›…èé–‹è³½ï¼ˆå¥³å­çµ„ï¼‰", "è¦ªå‹åœ˜é—œéµé»ä½åŠ æ²¹", "ç”·ç”Ÿé ˜å–è‡ªè¡Œè»Šï¼ˆå…‰æ­¦ã€çš“ä¸­å“¥ã€å¿—è£•å“¥ï¼‰", "ç”·ç”Ÿè½‰æ›å€ Check-in", "æ™šé¤æ…¶ç¥/æ—©ä¼‘æ¯"],
                food_recommendation: "è³½å¾Œæ…¶ç¥ï¼šäº«å—é¦¬è²æ‹‰çš„é«˜ç´šæµ·é®®é¤å»³æˆ– Tapas barã€‚",
                accommodationName: "La Maestranza 8 b Lotta (çºŒä½)",
                accommodationAddress: "Calle las ventas, Bajo, 29670 é¦¬è²æ‹‰, è¥¿ç­ç‰™"
            },
            { 
                day: 6, 
                date: "11/9 (æ—¥)", 
                location: "é¦¬è²æ‹‰", 
                title: "ğŸ”¥ é¦¬è²æ‹‰ï¼ˆç”·å­çµ„è³½äº‹ï¼‰", 
                transport: "SUV å”åŠ©å¾Œå‹¤ã€‚", 
                activities: ["8:00 ç”·å­çµ„é–‹è³½ï¼ˆå…‰æ­¦ã€çš“ä¸­å“¥ã€å¿—è£•å“¥ï¼‰", "ä¸‹åˆè½‰æ›å€ Check-out", "æ…¶ç¥æ™šå®´"],
                food_recommendation: "è³½å¾Œæ…¶ç¥æ™šå®´ï¼Œå…¨é«”ç‚ºä¸‰ä½éµäººå–é‡‡ï¼",
                accommodationName: "La Maestranza 8 b Lotta (æœ€å¾Œä¸€æ™š)",
                accommodationAddress: "Calle las ventas, Bajo, 29670 é¦¬è²æ‹‰, è¥¿ç­ç‰™"
            },
            { 
                day: 7, 
                date: "11/10 (ä¸€)", 
                location: "é¦¬è²æ‹‰ â†’ éš†é” â†’ å¡ç¶­äº", 
                title: "é¦¬è²æ‹‰ â†’ éš†é” â†’ å¡ç¶­äº", 
                transport: "SUV è‡ªé§• (é¦¬è²æ‹‰-éš†é”-å¡ç¶­äº: 3hr 5minï¼Œå«éš†é”åœç•™ 2hr)ã€‚", 
                activities: ["8:00 æ—©é¤", "9:30 é€€æˆ¿ã€é‚„è‡ªè¡Œè»Š", "10:30 å‡ºç™¼", "12:00 æŠµé”éš†é”", "éš†é”æ–°æ©‹ & è€åŸï¼ˆç´„ 2hrï¼‰", "14:00 é›¢é–‹éš†é”", "16:30 æŠµé”å¡ç¶­äº", "20:00 æ™šé¤/ä½›æœ—æ˜å“¥ç§€ï¼ˆå¯é¸ï¼‰"],
                food_recommendation: "æ¨è–¦åœ¨éš†é”æ‰¾ä¸€é–“é¢å‘å³½è°·çš„æ™¯è§€é¤å»³äº«ç”¨åˆé¤ï¼ŒåŒæ™‚æ¬£è³æ–°æ©‹çš„å£¯éº—æ™¯è‰²ã€‚",
                accommodationName: "è–å…‹é­¯æ–¯è¡—å€çš„è¿·äººå…¬å¯“ + ä¼Šç“¦æ‹‰ä¼¯çˆµä¸‰ä¸–å„ªé›…ä¹‹å®¶é…’åº— (2æ™š)",
                accommodationAddress: "Calle Conde de Ibarra NÃºmero 12 portal 1, 1Âº A, è€åŸå€, 41004 å¡ç¶­åˆ©äº, è¥¿ç­ç‰™"
            },
            { 
                day: 8, 
                date: "11/11 (äºŒ)", 
                location: "å¡ç¶­äº", 
                title: "å¡ç¶­äºï¼ˆæ·±åº¦éŠï¼‰", 
                transport: "å¸‚å€å…§ç§»å‹•ï¼ˆæ­¥è¡Œç‚ºä¸»ï¼‰ã€‚", 
                activities: ["æ°´é“æ©‹", "å¡ç¶­äºç‹å®®ï¼ˆAlcÃ¡zarï¼‰", "å¤§æ•™å ‚ + å¸Œæ‹‰é”å¡”", "è¥¿ç­ç‰™å»£å ´", "è–åå­—å€æ¼«æ­¥", "æ™šä¸Šä½›æœ—æ˜å“¥è¡¨æ¼”"],
                food_recommendation: "å¡ç¶­äºçš„ç¶“å…¸èœé¤šæ˜¯ Cola de Toro (ç‡‰ç‰›å°¾)ï¼Œä»¥åŠæ­é…ç•¶åœ°é›ªåˆ©é…’çš„ JamÃ³n IbÃ©rico (ä¼Šæ¯”åˆ©ç«è…¿)ã€‚",
                accommodationName: "è–å…‹é­¯æ–¯è¡—å€çš„è¿·äººå…¬å¯“ + ä¼Šç“¦æ‹‰ä¼¯çˆµä¸‰ä¸–å„ªé›…ä¹‹å®¶é…’åº— (çºŒä½)",
                accommodationAddress: "Calle Conde de Ibarra NÃºmero 12 portal 1, 1Âº A, è€åŸå€, 41004 å¡ç¶­åˆ©äº, è¥¿ç­ç‰™"
            },
            { 
                day: 9, 
                date: "11/12 (ä¸‰)", 
                location: "å¡ç¶­äº â†’ æ¢…é‡Œé” â†’ å¡å¡é›·æ–¯", 
                title: "å¡ç¶­äº â†’ æ¢…é‡Œé” â†’ å¡å¡é›·æ–¯", 
                transport: "SUV è‡ªé§• (å¡ç¶­äº-å¡å¡é›·æ–¯: 2hrï¼Œå«æ¢…é‡Œé”åœç•™)ã€‚", 
                activities: ["ä¸Šåˆå¡ç¶­äºè³¼ç‰©/éºç æ™¯é»", "ä¸­åˆå‡ºç™¼", "æ¢…é‡Œé”ç¾…é¦¬åŠ‡é™¢èˆ‡ç«¶æŠ€å ´", "ä¸‹åˆæŠµé”å¡å¡é›·æ–¯", "å¡å¡é›·æ–¯è€åŸå€æ•£æ­¥", "æ™šé¤"],
                food_recommendation: "å¡å¡é›·æ–¯ä»¥ç«è…¿å’Œå¥¶é…ªèåã€‚å¿…è©¦ Torta del Casar (æ¿ƒéƒç¶¿ç¾Šå¥¶é…ª) å’Œé«˜å“è³ªçš„ IbÃ©rico Pork è£½å“ã€‚",
                accommodationName: "æ©çˆ¾èŒ¨å¥§å…‹å¤šå®®æ®¿é…’åº—",
                accommodationAddress: "Plaza San Antonio, 10003 CÃ¡ceres, Spain"
            },
            { 
                day: 10, 
                date: "11/13 (å››)", 
                location: "å¡å¡é›·æ–¯ â†’ é¦¬å¾·é‡Œ", 
                title: "å¡å¡é›·æ–¯ â†’ ç‰¹é­¯å¸Œç•¥ â†’ Oropesa â†’ é¦¬å¾·é‡Œ", 
                transport: "SUV è‡ªé§• (å¡å¡é›·æ–¯-é¦¬å¾·é‡Œ: 3.5hr / 297kmï¼Œå«åœç•™)ã€‚", 
                activities: ["7:00 æ™¨è·‘ 30min", "8:00 æ—©é¤", "9:00 å‡ºç™¼", "09:45 æŠµé”ç‰¹é­¯å¸Œç•¥", "12:15 æŠµé” Oropesa", "13:30 åˆé¤", "15:00 å‡ºç™¼å¾€é¦¬å¾·é‡Œ", "16:30-17:00 æŠµé”é¦¬å¾·é‡Œã€é‚„è»Š", "20:00 æ™šé¤ + æ•£æ­¥"],
                food_recommendation: "é¦¬å¾·é‡Œæ™šé¤æ¨è–¦ï¼šæ‰¾ä¸€å®¶é“åœ°çš„è¥¿ç­ç‰™å°åƒåº—äº«ç”¨å„å¼ Tapasã€‚",
                accommodationName: "é¦¬å¾·é‡Œ Airbnb å…¬å¯“ A + B (2æ™š)",
                accommodationAddress: "Calle del Arenal, 8, 28013 Madrid, Spain"
            },
            { 
                day: 11, 
                date: "11/14 (äº”)", 
                location: "é¦¬å¾·é‡Œ", 
                title: "é¦¬å¾·é‡Œï¼ˆå¸‚å€è§€å…‰ï¼‰", 
                transport: "å¸‚å€å…§ç§»å‹•ï¼ˆåœ°éµ/æ­¥è¡Œï¼‰ã€‚", 
                activities: ["æ™®æ‹‰å¤šåšç‰©é¤¨", "é¦¬å¾·é‡Œç‹å®®", "é¦¬ç´„çˆ¾å»£å ´", "å¤ªé™½é–€å»£å ´", "Gran VÃ­a è³¼ç‰©", "å‘Šåˆ¥æ™šé¤"],
                food_recommendation: "æ¨è–¦åœ¨è–ç±³æ ¼çˆ¾å¸‚å ´ (Mercado de San Miguel) äº«å—è±å¯Œçš„ Tapas é«”é©—ã€‚",
                accommodationName: "é¦¬å¾·é‡Œ Airbnb å…¬å¯“ A + B (æœ€å¾Œä¸€æ™š)",
                accommodationAddress: "Calle del Arenal, 8, 28013 Madrid, Spain"
            },
            { 
                day: 12, 
                date: "11/15 (å…­)", 
                location: "é¦¬å¾·é‡Œ â†’ å°ç£", 
                title: "é¦¬å¾·é‡Œ â†’ å°ç£", 
                transport: "11:00 å‰å¾€é¦¬å¾·é‡Œæ©Ÿå ´ï¼Œ14:25 åœ‹éš›èˆªç­èµ·é£›ã€‚", 
                activities: ["æ•´ç†è¡Œæ", "æœ€å¾Œçš„è¥¿ç­ç‰™æ—©é¤", "11:00 å‰å¾€æ©Ÿå ´", "è¾¦ç†å ±åˆ°èˆ‡é€€ç¨…", "14:25 åœ‹éš›èˆªç­", "è¿”å›å°ç£"],
                food_recommendation: "",
                accommodationName: "ç„¡ (æœ¬æ—¥é€€æˆ¿/è¿”ç¨‹)",
                accommodationAddress: ""
            }
        ];

        document.addEventListener('DOMContentLoaded', () => {
            renderChecklist();
            renderTimeline();
            renderCostChart();
            document.getElementById('total-cost').textContent = new Intl.NumberFormat('zh-TW').format(TRIP_DATA.estimatedCost);
        });

        const checklistContainer = document.getElementById('checklist-container');

        function renderChecklist() {
            checklistContainer.innerHTML = CHECKLIST_STATE.map(item => `
                <div id="item-${item.id}" class="flex items-center p-3 rounded-lg cursor-pointer transition duration-150 ${item.completed ? 'bg-green-50' : 'bg-gray-100 hover:bg-gray-200'}" onclick="toggleChecklist(${item.id})">
                    <span class="text-xl mr-3 ${item.completed ? 'text-green-600' : 'text-gray-400'}">
                        ${item.completed ? 'âœ”' : 'â˜'}
                    </span>
                    <p class="text-gray-700 font-medium ${item.completed ? 'line-through text-gray-500' : ''}">${item.text}</p>
                </div>
            `).join('');
        }

        function toggleChecklist(id) {
            const index = CHECKLIST_STATE.findIndex(item => item.id === id);
            if (index !== -1) {
                CHECKLIST_STATE[index].completed = !CHECKLIST_STATE[index].completed;
                renderChecklist();
            }
        }

        const timelineContainer = document.getElementById('timeline-container');

        function renderTimeline() {
            timelineContainer.innerHTML = ITINERARY_DATA.map(item => `
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <button class="flex items-center justify-between w-full p-4 bg-white rounded-lg shadow-md hover:bg-indigo-50 transition duration-150 focus:outline-none" onclick="toggleDay(${item.day})">
                        <div class="flex items-center gap-4 flex-1">
                            <span class="text-lg font-bold ${(item.day === 5 || item.day === 6) ? 'text-amber-600' : 'text-indigo-700'}">${(item.day === 5 || item.day === 6) ? 'ğŸ”¥ ' : ''}Day ${item.day}: ${item.title}</span>
                        </div>
                        <div class="flex items-center gap-3">
                            <span class="text-sm font-medium text-gray-500 whitespace-nowrap">${item.date}</span>
                            <span id="icon-${item.day}" class="text-xl text-indigo-500">â–¼</span>
                        </div>
                    </button>

                    <div id="details-${item.day}" class="p-4 mt-2 ml-5 bg-white rounded-lg border border-indigo-100 hidden">
                        <!-- Accommodation Details -->
                        ${item.accommodationName && item.accommodationName.indexOf('ç„¡') === -1 && item.accommodationName.indexOf('æœ¬æ—¥é€€æˆ¿') === -1 ? `
                            <h4 class="text-md font-semibold text-gray-700 mb-2 mt-1">ğŸ  ç•¶æ™šä½å®¿ï¼š<span class="text-green-600">${item.accommodationName}</span></h4>
                            ${item.accommodationAddress && item.accommodationAddress !== '' ? `
                                <p class="text-gray-600 mb-2 text-sm">
                                    ğŸ“ åœ°å€: ${item.accommodationAddress} 
                                    <a href="${getGoogleMapsLink(item.accommodationAddress)}" target="_blank" class="ml-2 text-indigo-500 hover:text-indigo-700 font-medium underline">Google Maps</a>
                                </p>
                            ` : ''}
                            <hr class="my-3 border-indigo-100">
                        ` : ''}
                        
                        <!-- Transport Details -->
                        <h4 class="text-md font-semibold text-gray-700 mb-2">ğŸšŒ äº¤é€šï¼š<span class="text-indigo-600 font-normal">${item.transport}</span></h4>
                        
                        <!-- Activities -->
                        <h4 class="text-md font-semibold text-gray-700 mb-3">ğŸ“‹ ç•¶æ—¥æ´»å‹•:</h4>
                        <ul class="list-disc list-inside text-gray-600 pl-4 space-y-1">
                            ${item.activities.map(act => `<li>${act}</li>`).join('')}
                        </ul>
                        
                        <!-- FOOD RECOMMENDATION SECTION -->
                        ${item.food_recommendation ? `
                            <h4 class="text-md font-semibold text-gray-700 mt-4 mb-1">ğŸ½ï¸ ç¾é£Ÿæ¨è–¦:</h4>
                            <p class="text-amber-700 bg-amber-50 p-2 rounded-lg text-sm">${item.food_recommendation}</p>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        function toggleDay(dayId) {
            const detailsElement = document.getElementById(`details-${dayId}`);
            const iconElement = document.getElementById(`icon-${dayId}`);

            if (detailsElement.classList.contains('hidden')) {
                document.querySelectorAll('[id^="details-"]').forEach(el => el.classList.add('hidden'));
                document.querySelectorAll('[id^="icon-"]').forEach(el => el.textContent = 'â–¼');

                detailsElement.classList.remove('hidden');
                iconElement.textContent = 'â–²';
            } else {
                detailsElement.classList.add('hidden');
                iconElement.textContent = 'â–¼';
            }
        }

        function renderCostChart() {
            const ctx = document.getElementById('costBreakdownChart').getContext('2d');
            const data = TRIP_DATA.costBreakdown;

            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: data.map(d => d.label),
                    datasets: [{
                        data: data.map(d => d.amount),
                        backgroundColor: data.map(d => d.color),
                        hoverOffset: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                font: { size: 13, family: 'Inter' }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed;
                                    const percentage = data[context.dataIndex].percentage.toFixed(2);
                                    return `${label}: NT$${new Intl.NumberFormat('zh-TW').format(value)} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
